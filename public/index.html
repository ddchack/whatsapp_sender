<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WhatsApp Sender</title>
    <!-- 
        ============================================
        WhatsApp Sender - Sistema de Mensajer√≠a Masiva
        Developed by: Carlos David Donoso Cordero (ddchack)
        Website: carlos-donoso.com
        ============================================
    -->
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="logo">
                <span class="logo-icon">üì±</span>
                <span class="logo-text">WA Sender</span>
            </div>
            
            <nav class="nav-menu">
                <a href="#" class="nav-item active" data-section="dashboard">
                    <span class="nav-icon">üìä</span>
                    <span>Dashboard</span>
                </a>
                <a href="#" class="nav-item" data-section="contacts">
                    <span class="nav-icon">üë•</span>
                    <span>Contactos</span>
                </a>
                <a href="#" class="nav-item" data-section="templates">
                    <span class="nav-icon">üìù</span>
                    <span>Plantillas</span>
                </a>
                <a href="#" class="nav-item" data-section="send">
                    <span class="nav-icon">üì§</span>
                    <span>Enviar</span>
                </a>
                <a href="#" class="nav-item" data-section="history">
                    <span class="nav-icon">üìã</span>
                    <span>Historial</span>
                </a>
            </nav>

            <div class="wa-status">
                <div class="status-indicator disconnected" id="statusIndicator">
                    <span class="status-dot"></span>
                    <span class="status-text">Desconectado</span>
                </div>
                <button class="btn btn-connect" id="btnConnect">Conectar</button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Dashboard Section -->
            <section class="section active" id="sectionDashboard">
                <div class="section-header">
                    <h1>Dashboard</h1>
                </div>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon">üë•</div>
                        <div class="stat-info">
                            <span class="stat-value" id="statContacts">0</span>
                            <span class="stat-label">Contactos</span>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">‚úÖ</div>
                        <div class="stat-info">
                            <span class="stat-value" id="statSent">0</span>
                            <span class="stat-label">Enviados Hoy</span>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">‚ùå</div>
                        <div class="stat-info">
                            <span class="stat-value" id="statFailed">0</span>
                            <span class="stat-label">Fallidos Hoy</span>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">üìù</div>
                        <div class="stat-info">
                            <span class="stat-value" id="statTemplates">0</span>
                            <span class="stat-label">Plantillas</span>
                        </div>
                    </div>
                </div>

                <!-- QR Code Modal -->
                <div class="qr-container" id="qrContainer" style="display: none;">
                    <h2>Escanea el c√≥digo QR con WhatsApp</h2>
                    <div class="qr-wrapper">
                        <img src="" alt="QR Code" id="qrCode">
                    </div>
                    <p>Abre WhatsApp en tu tel√©fono ‚Üí Men√∫ ‚Üí Dispositivos vinculados ‚Üí Vincular dispositivo</p>
                </div>

                <div class="quick-actions">
                    <h2>Acciones R√°pidas</h2>
                    <div class="action-buttons">
                        <button class="btn btn-primary" onclick="navigateTo('contacts')">
                            <span>üë•</span> Importar Contactos
                        </button>
                        <button class="btn btn-primary" onclick="navigateTo('templates')">
                            <span>üìù</span> Crear Plantilla
                        </button>
                        <button class="btn btn-primary" onclick="navigateTo('send')">
                            <span>üì§</span> Enviar Mensajes
                        </button>
                    </div>
                </div>
            </section>

            <!-- Contacts Section -->
            <section class="section" id="sectionContacts">
                <div class="section-header">
                    <h1>Contactos</h1>
                    <div class="header-actions">
                        <select id="filterList" class="select-input">
                            <option value="">Todas las listas</option>
                        </select>
                        <button class="btn btn-secondary" onclick="showImportModal()">
                            üì• Importar CSV
                        </button>
                        <button class="btn btn-primary" onclick="showAddContactModal()">
                            + Agregar
                        </button>
                    </div>
                </div>

                <div class="card">
                    <div class="table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th><input type="checkbox" id="selectAllContacts"></th>
                                    <th>Tel√©fono</th>
                                    <th>Nombre</th>
                                    <th>Email</th>
                                    <th>Empresa</th>
                                    <th>Lista</th>
                                    <th>Acciones</th>
                                </tr>
                            </thead>
                            <tbody id="contactsTable">
                                <!-- Contactos din√°micos -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Gesti√≥n de Listas -->
                <div class="card mt-4">
                    <h3>Gesti√≥n de Listas</h3>
                    <div class="list-management">
                        <div class="add-list-form">
                            <input type="text" id="newListName" placeholder="Nombre de la lista" class="text-input">
                            <button class="btn btn-primary" onclick="createList()">Crear Lista</button>
                        </div>
                        <div class="lists-grid" id="listsGrid">
                            <!-- Listas din√°micas -->
                        </div>
                    </div>
                </div>
            </section>

            <!-- Templates Section -->
            <section class="section" id="sectionTemplates">
                <div class="section-header">
                    <h1>Plantillas</h1>
                    <button class="btn btn-primary" onclick="showTemplateModal()">
                        + Nueva Plantilla
                    </button>
                </div>

                <div class="templates-info card">
                    <h3>Variables disponibles</h3>
                    <p>Usa estas variables en tus mensajes para personalizarlos:</p>
                    <div class="variables-list">
                        <code>{nombre}</code>
                        <code>{email}</code>
                        <code>{empresa}</code>
                        <code>{telefono}</code>
                    </div>
                </div>

                <div class="templates-grid" id="templatesGrid">
                    <!-- Plantillas din√°micas -->
                </div>
            </section>

            <!-- Send Section -->
            <section class="section" id="sectionSend">
                <div class="section-header">
                    <h1>Enviar Mensajes</h1>
                </div>

                <div class="send-container">
                    <div class="card">
                        <h3>Configurar env√≠o</h3>
                        
                        <div class="form-group">
                            <label>Seleccionar lista de contactos</label>
                            <select id="sendList" class="select-input">
                                <option value="">Todos los contactos</option>
                            </select>
                            <span class="help-text" id="selectedCount">0 contactos seleccionados</span>
                        </div>

                        <div class="form-group">
                            <label>Usar plantilla (opcional)</label>
                            <select id="sendTemplate" class="select-input">
                                <option value="">-- Sin plantilla --</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label>Mensaje</label>
                            <textarea id="sendMessage" class="textarea-input" rows="5" placeholder="Hola {nombre}, te contactamos de {empresa}..."></textarea>
                            <span class="help-text">Variables: {nombre}, {email}, {empresa}, {telefono}</span>
                        </div>

                        <div class="form-group">
                            <label>Adjuntar archivo (opcional)</label>
                            <input type="file" id="sendMedia" class="file-input" accept="image/*,.pdf,.doc,.docx">
                        </div>

                        <div class="form-group">
                            <label>Vista previa</label>
                            <div class="message-preview" id="messagePreview">
                                <p>Escribe un mensaje para ver la vista previa...</p>
                            </div>
                        </div>

                        <button class="btn btn-success btn-lg" id="btnSend" onclick="sendMessages()">
                            üì§ Enviar Mensajes
                        </button>
                    </div>

                    <div class="card" id="sendProgress" style="display: none;">
                        <h3>Progreso de env√≠o</h3>
                        <div class="progress-bar">
                            <div class="progress-fill" id="progressFill"></div>
                        </div>
                        <p class="progress-text" id="progressText">0 / 0</p>
                        <div class="send-results" id="sendResults"></div>
                    </div>
                </div>
            </section>

            <!-- History Section -->
            <section class="section" id="sectionHistory">
                <div class="section-header">
                    <h1>Historial de Env√≠os</h1>
                    <button class="btn btn-secondary" onclick="clearHistory()">
                        üóëÔ∏è Limpiar Historial
                    </button>
                </div>

                <div class="card">
                    <div class="table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Fecha</th>
                                    <th>Tel√©fono</th>
                                    <th>Contacto</th>
                                    <th>Mensaje</th>
                                    <th>Estado</th>
                                </tr>
                            </thead>
                            <tbody id="historyTable">
                                <!-- Historial din√°mico -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Modal Import -->
    <div class="modal" id="importModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Importar Contactos</h2>
                <button class="modal-close" onclick="closeModal('importModal')">&times;</button>
            </div>
            <div class="modal-body">
                <p>El archivo CSV debe tener las columnas: <strong>telefono</strong> (obligatorio), nombre, email, empresa</p>
                <div class="form-group">
                    <label>Archivo CSV</label>
                    <input type="file" id="importFile" accept=".csv" class="file-input">
                </div>
                <div class="form-group">
                    <label>Importar a lista</label>
                    <select id="importList" class="select-input">
                        <option value="1">General</option>
                    </select>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('importModal')">Cancelar</button>
                <button class="btn btn-primary" onclick="importContacts()">Importar</button>
            </div>
        </div>
    </div>

    <!-- Modal Add Contact -->
    <div class="modal" id="addContactModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Agregar Contacto</h2>
                <button class="modal-close" onclick="closeModal('addContactModal')">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>Tel√©fono *</label>
                    <input type="text" id="contactPhone" class="text-input" placeholder="0999123456">
                </div>
                <div class="form-group">
                    <label>Nombre</label>
                    <input type="text" id="contactName" class="text-input" placeholder="Juan P√©rez">
                </div>
                <div class="form-group">
                    <label>Email</label>
                    <input type="email" id="contactEmail" class="text-input" placeholder="juan@email.com">
                </div>
                <div class="form-group">
                    <label>Empresa</label>
                    <input type="text" id="contactCompany" class="text-input" placeholder="Empresa S.A.">
                </div>
                <div class="form-group">
                    <label>Lista</label>
                    <select id="contactList" class="select-input">
                        <option value="1">General</option>
                    </select>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('addContactModal')">Cancelar</button>
                <button class="btn btn-primary" onclick="addContact()">Agregar</button>
            </div>
        </div>
    </div>

    <!-- Modal Template -->
    <div class="modal" id="templateModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="templateModalTitle">Nueva Plantilla</h2>
                <button class="modal-close" onclick="closeModal('templateModal')">&times;</button>
            </div>
            <div class="modal-body">
                <input type="hidden" id="templateId">
                <div class="form-group">
                    <label>Nombre de la plantilla *</label>
                    <input type="text" id="templateName" class="text-input" placeholder="Recordatorio de cita">
                </div>
                <div class="form-group">
                    <label>Contenido del mensaje *</label>
                    <textarea id="templateContent" class="textarea-input" rows="5" placeholder="Hola {nombre}, te recordamos..."></textarea>
                </div>
                <div class="form-group">
                    <label>Archivo adjunto (opcional)</label>
                    <input type="file" id="templateMedia" class="file-input" accept="image/*,.pdf,.doc,.docx">
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('templateModal')">Cancelar</button>
                <button class="btn btn-primary" onclick="saveTemplate()">Guardar</button>
            </div>
        </div>
    </div>

    <!-- Toast Notification -->
    <div class="toast" id="toast">
        <span class="toast-message"></span>
    </div>

    <script src="app.js"></script>
</body>
</html>
